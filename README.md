# lxhadoop
录信的定制版hadoop

鉴于hadoop在随机读写性能的低下,我们改了下hadoop在随机读写上的实现,旨在提升lucene在hadoop上的性能.<br>
1.lucene是一个倒排索引,在更新,检索,统计三个方面需要大量的使用随机读,通过hadoop的这个改动,可以大幅度的提升需要随机读的lucene的性能.<br>
2.目前测试通过这种改动可以将随机读写性能提升100~300倍-走网络与不走网络均可提升,如果基础网络不好,延迟较大则提升的倍数会更多.<br>
3.由于时间的关系,实现的比较粗糙,还依然有大量的提升空间可以改进,欢迎各位大神给与批评指正. 除了完善外,未来可以考虑引入mmap.<br>
4.测试程序参见BatchRead.java .<br>
5.以下为我在jdk15 SSD环境上的测试结果.<br>

export HADOOP_OPTS="-Xmx6000m -XX:+UseZGC"
./hadoop jar ./bb.jar cn.lucene.test.BatchRead    /allssd/a.doc $@
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:12@原始hdfs时间:2396
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:13@原始hdfs时间:2443
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:14@原始hdfs时间:2415
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:15@原始hdfs时间:2488
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:26@原始hdfs时间:2491
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:14@原始hdfs时间:2401
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:12@原始hdfs时间:2520
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:14@原始hdfs时间:2411
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:15@原始hdfs时间:2652
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:21@原始hdfs时间:2625
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:16@原始hdfs时间:2630
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:15@原始hdfs时间:2499
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:18@原始hdfs时间:2473
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:14@原始hdfs时间:2479
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:13@原始hdfs时间:2536
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:16@原始hdfs时间:2627
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:16@原始hdfs时间:2445
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:13@原始hdfs时间:2480
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:12@原始hdfs时间:2494
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:13@原始hdfs时间:2468
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:15@原始hdfs时间:2459
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:14@原始hdfs时间:2387
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:12@原始hdfs时间:2474
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:16@原始hdfs时间:2476
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:13@原始hdfs时间:2473
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:15@原始hdfs时间:2648
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:17@原始hdfs时间:2672
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:19@原始hdfs时间:2607
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:22@原始hdfs时间:2618
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:19@原始hdfs时间:2573
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:16@原始hdfs时间:2580
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:17@原始hdfs时间:2514
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:16@原始hdfs时间:2532
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:17@原始hdfs时间:2596
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:16@原始hdfs时间:2469
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:13@原始hdfs时间:2397
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:13@原始hdfs时间:2488
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:11@原始hdfs时间:2476
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:12@原始hdfs时间:2489
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:17@原始hdfs时间:2456
cmpdiff:比对结果:true@校验成功次数:10000@读取次数:10000@优化后时间:15@原始hdfs时间:241